<head>
  ...
  <!-- Thêm thư viện html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9fafb;
      color: #333;
    }

    header img {
      width: 100%;
      height: auto;
      border-bottom: 3px solid #eee;
    }

    /* Desktop: 6 sản phẩm / hàng */
    .product-list {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 16px;
      padding: 16px;
    }

    /* Mobile: 2 sản phẩm / hàng */
    @media (max-width: 768px) {
      .product-list {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .product {
      background: #fff;
      border-radius: 12px;
      padding: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .product:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 14px rgba(0,0,0,0.12);
    }
    .product img {
      width: 100%;
      max-height: 140px;
      object-fit: cover;
      border-radius: 10px;
    }
    ...
    .popup-buttons {
      display: flex;
      justify-content: center;
      margin-top: 14px;
    }
    .popup-buttons button {
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
    }
    .btn-back {
      background: #4CAF50;
      color: white;
      border: none;
    }
  </style>
</head>
<body>
  ...
  <!-- popup thanh toán -->
  <div class="popup">
    <div class="popup-content">
      <h3>Danh sách sản phẩm đã chọn</h3>
      <ul class="selected-products"></ul>
      <div class="popup-total"></div>
      <img src="photo_2025-09-26_19-53-24.jpg" alt="QR" style="width:140px; margin-top:8px;">
      <div class="qr-description">
        Quét mã QR để thanh toán, sau đó chụp bill và các sản phẩm bạn chọn gửi qua facebook cho mình nha. Cảm ơn bạn!
      </div>
      <div class="popup-buttons">
        <!-- Đổi nút "Quay lại" thành Submit -->
        <button class="btn-back">Submit</button>
      </div>
    </div>
  </div>
  ...
  <script>
    const products=document.querySelectorAll('.product');
    const totalEl=document.querySelector('.total');
    const payBtn=document.querySelector('.pay-btn');
    const popup=document.querySelector('.popup');
    const selectedList=document.querySelector('.selected-products');
    const popupTotal=document.querySelector('.popup-total');
    const thankPopup=document.querySelector('.thank-popup');

    products.forEach(product=>{
      const plus=product.querySelector('.plus');
      const minus=product.querySelector('.minus');
      const display=product.querySelector('.quantity-display');
      plus.addEventListener('click',()=>{
        let q=+display.textContent;
        let max=+product.dataset.max;
        if(q<max){
          q++;
          display.textContent=q;
        }
        updateTotal();
      });
      minus.addEventListener('click',()=>{
        let q=+display.textContent;
        if(q>0) q--;
        display.textContent=q;
        updateTotal();
      });
    });

    function updateTotal(){
      let total=0;
      products.forEach(p=>{
        const price=+p.dataset.price;
        const q=+p.querySelector('.quantity-display').textContent;
        total+=price*q;
      });
      totalEl.textContent='Tổng: '+total.toLocaleString('vi-VN')+'đ';
    }

    payBtn.addEventListener('click',()=>{
      selectedList.innerHTML='';
      let total=0;
      products.forEach(p=>{
        const name=p.dataset.name;
        const price=+p.dataset.price;
        const q=+p.querySelector('.quantity-display').textContent;
        if(q>0){
          const li=document.createElement('li');
          li.textContent=name+' x '+q;
          selectedList.appendChild(li);
          total+=price*q;
        }
      });
      popupTotal.textContent='Tổng: '+total.toLocaleString('vi-VN')+'đ';
      popup.classList.add('show');
    });

    // Submit = chụp popup
    document.querySelector('.btn-back').addEventListener('click',()=>{
      const popupContent=document.querySelector('.popup-content');
      html2canvas(popupContent).then(canvas=>{
        const link=document.createElement("a");
        link.download="popup.png";
        link.href=canvas.toDataURL();
        link.click();
      });
    });

    document.querySelector('.btn-thank-close').addEventListener('click',()=>{
      thankPopup.classList.remove('show');
    });

    // Reset tồn kho (không dùng localStorage nữa)
    document.querySelector('.reset-btn').addEventListener('click',()=>{
      products.forEach(p=>{
        let max=10;
        p.dataset.max=max;
        p.querySelector('.stock').textContent=max;
        p.querySelector('.quantity-display').textContent='0';
      });
      updateTotal();
    });
  </script>
</body>
